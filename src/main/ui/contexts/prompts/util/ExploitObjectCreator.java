package ui.contexts.prompts.util;

import model.gadgets.ExploitObject;
import ui.contexts.ConsoleContext;
import ui.contexts.prompts.PromptContext;

import java.util.ArrayList;
import java.util.List;

public class ExploitObjectCreator extends PromptContext {
    private final ExploitObject exploitObject;
    private final ArrayList<List<String>> promptData;
    private final ArrayList<String> responseData;

    public ExploitObjectCreator(
            ConsoleContext parentContext,
            ExploitObject exploitObject,
            ArrayList<List<String>> promptData
    ) {
        this(parentContext, exploitObject, promptData, new ArrayList<>());
    }

    public ExploitObjectCreator(
            ConsoleContext parentContext,
            ExploitObject exploitObject,
            ArrayList<List<String>> promptData,
            ArrayList<String> responseData
    ) {
        super(parentContext, promptData.get(0).get(0), promptData.get(0).get(1));

        this.promptData = promptData;
        this.exploitObject = exploitObject;
        this.responseData = responseData;

        promptData.remove(0);
    }

    public ConsoleContext handleInputInternal(String input) {
        responseData.add(input);

        if (promptData.size() > 0) {
            return new ExploitObjectCreator(getParentContext(), exploitObject, promptData, responseData);
        } else {
            exploitObject.fromList(responseData);
            return new AddExploitObjectToIndex(getParentContext(), exploitObject);
        }
    }
}
